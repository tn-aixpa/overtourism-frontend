<div class="container my-4">
    <!-- Dropdown KPI -->
    <div class="dropdown w-50 mb-3">
      <button class="btn btn-outline-primary w-100 d-flex justify-content-between align-items-center" 
              type="button" data-bs-toggle="dropdown" aria-expanded="false">
        <span>{{ getKpiName(selectedKpi) || 'Seleziona Indicatore' }}</span>
        <span class="material-icons ms-2">expand_more</span>
      </button>
      <div class="dropdown-menu w-100">
        <div class="link-list-wrapper">
          <ul class="link-list">
            <li *ngFor="let k of kpis">
              <a class="list-item" (click)="selectKpi(k.key)">
                <span>{{ k.title }}</span>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  
    <!-- Accordion Help -->
    <div class="accordion mb-3" *ngIf="selectedHelp">
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingHelp">
          <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                  data-bs-target="#collapseHelp" aria-expanded="true" aria-controls="collapseHelp">
            Descrizione
          </button>
        </h2>
        <div id="collapseHelp" class="accordion-collapse collapse show" aria-labelledby="headingHelp">
          <div class="accordion-body">
            {{ selectedHelp }}
          </div>
        </div>
      </div>
    </div>
  
    <!-- Tabs -->
    <it-tab-container (tabSelected)="onTabSelected($event)">
      <it-tab-item label="Mappa" icon="map-marker" [active]="activeTab === 'mappa'">
        <app-overtourism-map 
          *ngIf="activeTab === 'mappa'"
          [data]="rawData" 
          [geojson]="geojson" 
          [selectedKpi]="selectedKpi"
          [featureIdKey]="featureIdKey"
          [hoverTemplateBuilder]="hoverTemplateBuilder"
          [locationsCol]="locationsCol">
        </app-overtourism-map>
      </it-tab-item>
  
      <it-tab-item label="Grafici" icon="chart-line" [active]="activeTab === 'grafici'">
        <app-overtourism-charts 
          *ngIf="activeTab === 'grafici'"
          [data]="rawData" 
          [selectedKpi]="selectedKpi" 
          [kpis]="kpis"
          [hoverTemplateBuilder]="hoverTemplateBuilder">
        </app-overtourism-charts>
      </it-tab-item>
    </it-tab-container>
  </div>
  